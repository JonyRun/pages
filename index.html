<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <script src="https://telegram.org/js/telegram-web-app.js"></script>
        <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
        <style>
            .root {
                width: 100dvw;
                height: 100dvh;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .TOP_LABEL {
                display: flex;
                flex-direction: column;
                align-items: center;
                font-size: 12px;
                color: #2aabee;
                width: 100dvw;
            }
            .center {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                width: 100dvw;
                height: 100dvh;
            }
            .startButton {
                width: 30dvw;
                aspect-ratio: 1/1;
                background-color: #2aabee;
                border-radius: 50%;
            }
        </style>
    </head>
    <body>
        <div class="root">
            <div class="TOP_LABEL">
                <h1 translate="no">CRIPTO RULLET</h1>
            </div>
            <div class="center">
                <div class="startButton" onclick="callButton()"></div>
                <div id="client">client</div>
            </div>
            <div id="ton-connect"></div>
            <script>
                const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
                    manifestUrl: 'https://<YOUR_APP_URL>/tonconnect-manifest.json',
                    buttonRootId: 'ton-connect'
                });
            </script>
            <script>
                async function connectToWallet() {
                    const connectedWallet = await tonConnectUI.connectWallet();
                    // Do something with connectedWallet if needed
                    console.log(connectedWallet);
                }
            
                // Call the function
                connectToWallet().catch(error => {
                    console.error("Error connecting to wallet:", error);
                });
            </script>
            <script>
                // Ensure the Telegram.WebApp object exists before accessing its properties
                document.addEventListener('DOMContentLoaded', (event) => {
                    if (window.Telegram && window.Telegram.WebApp) {
                        let tg = window.Telegram.WebApp;
                        tg.MainButton.text = 'Changed Text';
                        tg.expand();
            
                        let client = document.getElementById('client');
                        let profName = document.createElement('p');
                        profName.innerText = `${tg.initDataUnsafe.user.language_code}`;
                        client.appendChild(profName);
            
                        let userid = document.createElement('p');
                        userid.innerText = `${tg.initDataUnsafe.user.id}`;
                        client.appendChild(userid);
            
                        console.log('Page loaded');
                    } else {
                        console.error('Telegram.WebApp object is not available');
                    }
                });
            
                // Define the callButton function outside the event listener
                function callButton() {
                    let client = document.getElementById('client');
                    let profName = document.createElement('p');
                    profName.innerText = `test`;
                    client.appendChild(profName);
                    tg.sendData('test');
                    if (window.Telegram && window.Telegram.WebApp) {
                        console.log("Button clicked");
                        window.Telegram.WebApp.sendData('test');
                    } else {
                        console.error('Telegram.WebApp object is not available');
                    }
                }
            </script>
    </body>
</html>
